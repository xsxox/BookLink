<!DOCTYPE html>
<html lang="zh-CN" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘å¸ƒä¹¦ç± - BookLink</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
    <div id="navbar-placeholder"></div>

    <div class="container pb-5"> <!-- åº•éƒ¨åŠ ç‚¹ padding é˜²æ­¢è´´åº• -->
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                
                <!-- [ä¿®æ”¹] p-4 p-md-5: ä¿æŒå¤§å†…è¾¹è· -->
                <div class="card shadow-lg border-0 p-4 p-md-5" style="border-radius: 24px;">
                    
                    <div class="text-center mb-5"> <!-- æ ‡é¢˜è·ç¦»ä¸‹æ–¹åŠ å¤§åˆ° mb-5 -->
                        <h2 class="fw-bold" style="color: var(--primary-color);">âœ¨ å‘å¸ƒæ–°ä¹¦</h2>
                        <p class="text-muted small mt-2">åˆ†äº«ä½ çš„è—ä¹¦ï¼Œå¯»æ‰¾æ–°çš„è¯»è€…</p>
                    </div>

                    <form id="upload-form">
                        <!-- mb-3 -> mb-4: æ‹‰å¤§æ¯ä¸€è¡Œçš„é—´è· -->
                        <div class="mb-4">
                            <!-- [ä¿®æ”¹] mb-2: è®©æ ‡ç­¾å’Œè¾“å…¥æ¡†åˆ†å¼€ä¸€ç‚¹ -->
                            <label class="form-label fw-bold mb-2">ä¹¦å</label>
                            <input type="text" name="title" class="form-control form-control-lg" placeholder="è¯·è¾“å…¥ä¹¦å" required>
                        </div>
                        
                        <div class="mb-4">
                            <label class="form-label fw-bold mb-2">ä½œè€…</label>
                            <input type="text" name="author" class="form-control form-control-lg" placeholder="è¯·è¾“å…¥ä½œè€…">
                        </div>
                        
                        <div class="mb-4">
                            <br>
                            <label class="form-label fw-bold mb-2">å°é¢å›¾ç‰‡</label>
                            <input type="file" name="coverImage" class="form-control" accept="image/*">
                            <br>
                        </div>

                        <div class="mb-5"> <!-- æè¿°æ¡†é€šå¸¸æ¯”è¾ƒå¤§ï¼Œä¸‹é¢ç•™æ›´å¤šç©ºé—´ -->
                            <label class="form-label fw-bold mb-2">æè¿° / æ¨èè¯­</label>
                            <textarea name="description" class="form-control" rows="5" placeholder="è¿™æœ¬ä¹¦è®²äº†ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæ¨èå®ƒï¼Ÿ..."></textarea>
                        </div>

                        <div class="d-grid">
                            <!-- æŒ‰é’®åŠ å¤§ padding -->
                            <button type="submit" class="btn btn-primary btn-lg rounded-pill shadow-sm py-3" style="font-size: 1.15rem;">
                                ğŸš€ ç«‹å³å‘å¸ƒ
                            </button>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.getElementById('upload-form').onsubmit = async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = 'å‘å¸ƒä¸­...';
            btn.disabled = true;

            const formData = new FormData(e.target);

            try {
                const res = await fetch('/api/books', {
                    method: 'POST',
                    body: formData
                });
                const data = await res.json();
                
                if(data.success) {
                    window.location.href = 'index.html';
                } else {
                    alert(data.error || 'å‘å¸ƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç™»å½•çŠ¶æ€');
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            } catch (err) {
                console.error(err);
                alert("ç½‘ç»œé”™è¯¯ï¼Œä¸Šä¼ å¤±è´¥");
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }
        initNavbar();
    </script>
</body>
</html>